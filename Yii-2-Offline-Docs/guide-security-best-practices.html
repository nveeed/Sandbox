<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from www.yiiframework.com/doc-2.0/guide-security-best-practices.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 27 May 2015 18:11:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="assets/c268c820/css/bootstrap.css" rel="stylesheet">
<link href="assets/420f52a4/style.css" rel="stylesheet">
<script src="assets/4d3f04b3/jquery.js"></script>
<script src="assets/c268c820/js/bootstrap.js"></script>
<script src="assets/7ba40f0b/jssearch.js"></script>    <title>The Definitive Guide to Yii 2.0</title>
</head>
<body>

<div class="wrap">
    <nav id="w1194" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w1194-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="index-2.html">The Definitive Guide to Yii 2.0</a></div><div id="w1194-collapse" class="collapse navbar-collapse"><ul id="w1195" class="navbar-nav nav"><li><a href="index-2.html">Class reference</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">Extensions <b class="caret"></b></a><ul id="w1196" class="dropdown-menu"><li><a href="ext-apidoc-index.html" tabindex="-1">apidoc</a></li>
<li><a href="ext-authclient-index.html" tabindex="-1">authclient</a></li>
<li><a href="ext-bootstrap-index.html" tabindex="-1">bootstrap</a></li>
<li><a href="ext-codeception-index.html" tabindex="-1">codeception</a></li>
<li><a href="ext-composer-index.html" tabindex="-1">composer</a></li>
<li><a href="ext-debug-index.html" tabindex="-1">debug</a></li>
<li><a href="ext-elasticsearch-index.html" tabindex="-1">elasticsearch</a></li>
<li><a href="ext-faker-index.html" tabindex="-1">faker</a></li>
<li><a href="ext-gii-index.html" tabindex="-1">gii</a></li>
<li><a href="ext-imagine-index.html" tabindex="-1">imagine</a></li>
<li><a href="ext-jui-index.html" tabindex="-1">jui</a></li>
<li><a href="ext-mongodb-index.html" tabindex="-1">mongodb</a></li>
<li><a href="ext-redis-index.html" tabindex="-1">redis</a></li>
<li><a href="ext-smarty-index.html" tabindex="-1">smarty</a></li>
<li><a href="ext-sphinx-index.html" tabindex="-1">sphinx</a></li>
<li><a href="ext-swiftmailer-index.html" tabindex="-1">swiftmailer</a></li>
<li><a href="ext-twig-index.html" tabindex="-1">twig</a></li></ul></li>
<li><a href="guide-README.html">Guide</a></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-1178" data-toggle="collapse" data-parent="#navigation">Introduction <b class="caret"></b></a><div id="navigation-1178" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-intro-yii.html">About Yii</a>
<a class="list-group-item" href="guide-intro-upgrade-from-v1.html">Upgrading from Version 1.1</a></div>
<a class="list-group-item" href="#navigation-1179" data-toggle="collapse" data-parent="#navigation">Getting Started <b class="caret"></b></a><div id="navigation-1179" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-start-installation.html">Installing Yii</a>
<a class="list-group-item" href="guide-start-workflow.html">Running Applications</a>
<a class="list-group-item" href="guide-start-hello.html">Saying Hello</a>
<a class="list-group-item" href="guide-start-forms.html">Working with Forms</a>
<a class="list-group-item" href="guide-start-databases.html">Working with Databases</a>
<a class="list-group-item" href="guide-start-gii.html">Generating Code with Gii</a>
<a class="list-group-item" href="guide-start-looking-ahead.html">Looking Ahead</a></div>
<a class="list-group-item" href="#navigation-1180" data-toggle="collapse" data-parent="#navigation">Application Structure <b class="caret"></b></a><div id="navigation-1180" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-structure-overview.html">Overview</a>
<a class="list-group-item" href="guide-structure-entry-scripts.html">Entry Scripts</a>
<a class="list-group-item" href="guide-structure-applications.html">Applications</a>
<a class="list-group-item" href="guide-structure-application-components.html">Application Components</a>
<a class="list-group-item" href="guide-structure-controllers.html">Controllers</a>
<a class="list-group-item" href="guide-structure-models.html">Models</a>
<a class="list-group-item" href="guide-structure-views.html">Views</a>
<a class="list-group-item" href="guide-structure-modules.html">Modules</a>
<a class="list-group-item" href="guide-structure-filters.html">Filters</a>
<a class="list-group-item" href="guide-structure-widgets.html">Widgets</a>
<a class="list-group-item" href="guide-structure-assets.html">Assets</a>
<a class="list-group-item" href="guide-structure-extensions.html">Extensions</a></div>
<a class="list-group-item" href="#navigation-1181" data-toggle="collapse" data-parent="#navigation">Handling Requests <b class="caret"></b></a><div id="navigation-1181" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-runtime-overview.html">Overview</a>
<a class="list-group-item" href="guide-runtime-bootstrapping.html">Bootstrapping</a>
<a class="list-group-item" href="guide-runtime-routing.html">Routing and URL Creation</a>
<a class="list-group-item" href="guide-runtime-requests.html">Requests</a>
<a class="list-group-item" href="guide-runtime-responses.html">Responses</a>
<a class="list-group-item" href="guide-runtime-sessions-cookies.html">Sessions and Cookies</a>
<a class="list-group-item" href="guide-runtime-handling-errors.html">Handling Errors</a>
<a class="list-group-item" href="guide-runtime-logging.html">Logging</a></div>
<a class="list-group-item" href="#navigation-1182" data-toggle="collapse" data-parent="#navigation">Key Concepts <b class="caret"></b></a><div id="navigation-1182" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-concept-components.html">Components</a>
<a class="list-group-item" href="guide-concept-properties.html">Properties</a>
<a class="list-group-item" href="guide-concept-events.html">Events</a>
<a class="list-group-item" href="guide-concept-behaviors.html">Behaviors</a>
<a class="list-group-item" href="guide-concept-configurations.html">Configurations</a>
<a class="list-group-item" href="guide-concept-aliases.html">Aliases</a>
<a class="list-group-item" href="guide-concept-autoloading.html">Class Autoloading</a>
<a class="list-group-item" href="guide-concept-service-locator.html">Service Locator</a>
<a class="list-group-item" href="guide-concept-di-container.html">Dependency Injection Container</a></div>
<a class="list-group-item" href="#navigation-1183" data-toggle="collapse" data-parent="#navigation">Working with Databases <b class="caret"></b></a><div id="navigation-1183" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-db-dao.html">Data Access Objects</a>
<a class="list-group-item" href="guide-db-query-builder.html">Query Builder</a>
<a class="list-group-item" href="guide-db-active-record.html">Active Record</a>
<a class="list-group-item" href="guide-db-migrations.html">Migrations</a>
<a class="list-group-item" href="guide-db-sphinx.html">Sphinx</a>
<a class="list-group-item" href="guide-db-redis.html">Redis</a>
<a class="list-group-item" href="guide-db-mongodb.html">MongoDB</a>
<a class="list-group-item" href="guide-db-elasticsearch.html">ElasticSearch</a></div>
<a class="list-group-item" href="#navigation-1184" data-toggle="collapse" data-parent="#navigation">Getting Data from Users <b class="caret"></b></a><div id="navigation-1184" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-input-forms.html">Creating Forms</a>
<a class="list-group-item" href="guide-input-validation.html">Validating Input</a>
<a class="list-group-item" href="guide-input-file-upload.html">Uploading Files</a>
<a class="list-group-item" href="guide-input-tabular-input.html">Collecting tabular input</a>
<a class="list-group-item" href="guide-input-multiple-models.html">Getting Data for Multiple Models</a></div>
<a class="list-group-item" href="#navigation-1185" data-toggle="collapse" data-parent="#navigation">Displaying Data <b class="caret"></b></a><div id="navigation-1185" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-output-formatter.html">Data Formatting</a>
<a class="list-group-item" href="guide-output-pagination.html">Pagination</a>
<a class="list-group-item" href="guide-output-sorting.html">Sorting</a>
<a class="list-group-item" href="guide-output-data-providers.html">Data Providers</a>
<a class="list-group-item" href="guide-output-data-widgets.html">Data Widgets</a>
<a class="list-group-item" href="guide-output-client-scripts.html">Working with Client Scripts</a>
<a class="list-group-item" href="guide-output-theming.html">Theming</a></div>
<a class="list-group-item active" href="#navigation-1186" data-toggle="collapse" data-parent="#navigation">Security <b class="caret"></b></a><div id="navigation-1186" class="submenu panel-collapse collapse in"><a class="list-group-item" href="guide-security-authentication.html">Authentication</a>
<a class="list-group-item" href="guide-security-authorization.html">Authorization</a>
<a class="list-group-item" href="guide-security-passwords.html">Working with Passwords</a>
<a class="list-group-item" href="guide-security-auth-clients.html">Auth Clients</a>
<a class="list-group-item active" href="guide-security-best-practices.html">Best Practices</a></div>
<a class="list-group-item" href="#navigation-1187" data-toggle="collapse" data-parent="#navigation">Caching <b class="caret"></b></a><div id="navigation-1187" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-caching-overview.html">Overview</a>
<a class="list-group-item" href="guide-caching-data.html">Data Caching</a>
<a class="list-group-item" href="guide-caching-fragment.html">Fragment Caching</a>
<a class="list-group-item" href="guide-caching-page.html">Page Caching</a>
<a class="list-group-item" href="guide-caching-http.html">HTTP Caching</a></div>
<a class="list-group-item" href="#navigation-1188" data-toggle="collapse" data-parent="#navigation">RESTful Web Services <b class="caret"></b></a><div id="navigation-1188" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-rest-quick-start.html">Quick Start</a>
<a class="list-group-item" href="guide-rest-resources.html">Resources</a>
<a class="list-group-item" href="guide-rest-controllers.html">Controllers</a>
<a class="list-group-item" href="guide-rest-routing.html">Routing</a>
<a class="list-group-item" href="guide-rest-response-formatting.html">Response Formatting</a>
<a class="list-group-item" href="guide-rest-authentication.html">Authentication</a>
<a class="list-group-item" href="guide-rest-rate-limiting.html">Rate Limiting</a>
<a class="list-group-item" href="guide-rest-versioning.html">Versioning</a>
<a class="list-group-item" href="guide-rest-error-handling.html">Error Handling</a></div>
<a class="list-group-item" href="#navigation-1189" data-toggle="collapse" data-parent="#navigation">Development Tools <b class="caret"></b></a><div id="navigation-1189" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-tool-debugger.html">Debug Toolbar and Debugger</a>
<a class="list-group-item" href="guide-tool-gii.html">Generating Code using Gii</a>
<a class="list-group-item" href="guide-tool-api-doc.html">Generating API Documentation</a></div>
<a class="list-group-item" href="#navigation-1190" data-toggle="collapse" data-parent="#navigation">Testing <b class="caret"></b></a><div id="navigation-1190" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-test-overview.html">Overview</a>
<a class="list-group-item" href="guide-test-environment-setup.html">Testing environment setup</a>
<a class="list-group-item" href="guide-test-unit.html">Unit Tests</a>
<a class="list-group-item" href="guide-test-functional.html">Functional Tests</a>
<a class="list-group-item" href="guide-test-acceptance.html">Acceptance Tests</a>
<a class="list-group-item" href="guide-test-fixtures.html">Fixtures</a></div>
<a class="list-group-item" href="#navigation-1191" data-toggle="collapse" data-parent="#navigation">Special Topics <b class="caret"></b></a><div id="navigation-1191" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-tutorial-advanced-app.html">Advanced Application Template</a>
<a class="list-group-item" href="guide-tutorial-start-from-scratch.html">Building Application from Scratch</a>
<a class="list-group-item" href="guide-tutorial-console.html">Console Commands</a>
<a class="list-group-item" href="guide-tutorial-core-validators.html">Core Validators</a>
<a class="list-group-item" href="guide-tutorial-i18n.html">Internationalization</a>
<a class="list-group-item" href="guide-tutorial-mailing.html">Mailing</a>
<a class="list-group-item" href="guide-tutorial-performance-tuning.html">Performance Tuning</a>
<a class="list-group-item" href="guide-tutorial-shared-hosting.html">Shared Hosting Environment</a>
<a class="list-group-item" href="guide-tutorial-template-engines.html">Template Engines</a>
<a class="list-group-item" href="guide-tutorial-yii-integration.html">Working with Third-Party Code</a></div>
<a class="list-group-item" href="#navigation-1192" data-toggle="collapse" data-parent="#navigation">Widgets <b class="caret"></b></a><div id="navigation-1192" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-widget-bootstrap.html">Bootstrap Widgets</a>
<a class="list-group-item" href="guide-widget-jui.html">jQuery UI Widgets</a></div>
<a class="list-group-item" href="#navigation-1193" data-toggle="collapse" data-parent="#navigation">Helpers <b class="caret"></b></a><div id="navigation-1193" class="submenu panel-collapse collapse"><a class="list-group-item" href="guide-helper-overview.html">Overview</a>
<a class="list-group-item" href="guide-helper-array.html">ArrayHelper</a>
<a class="list-group-item" href="guide-helper-html.html">Html</a>
<a class="list-group-item" href="guide-helper-url.html">Url</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <div class="fixlink"><a href="https://github.com/yiisoft/yii2/edit/master/docs/guide/security-best-practices.md" class="h1" title="Found an error? Please help us fix it. Thanks!"><span class="glyphicon glyphicon-pencil"></a></div>
        <h1>Security best practices <a href="#security-best-practices" id="security-best-practices" class="hashlink">&para;</a></h1><p>Below we'll review common security principles and describe how to avoid threats when developing applications using Yii.</p>
<h2>Basic principles <a href="#basic-principles" id="basic-principles" class="hashlink">&para;</a></h2><p>There are two main principles when it comes to security no matter which application is being developed:</p>
<ol>
<li>Filter input.</li>
<li>Escape output.</li>
</ol>
<h3>Filter input <a href="#filter-input" id="filter-input" class="hashlink">&para;</a></h3><p>Filter input means that input should never be considered safe and you should always check if the value you've got is
actually among allowed ones. For example, if we know that sorting could be done by three fields <code>title</code>, <code>created_at</code> and <code>status</code>
and the field could be supplied via user input, it's better to check the value we've got right where we're receiving it.
In terms of basic PHP that would look like the following:</p>
<pre><code class="language-php"><span style="color: #0000BB">$sortBy&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'sort'</span><span style="color: #007700">];<br />if&nbsp;(!</span><span style="color: #0000BB">in_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$sortBy</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'title'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'created_at'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'status'</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #0000BB">Exception</span><span style="color: #007700">(</span><span style="color: #DD0000">'Invalid&nbsp;sort&nbsp;value.'</span><span style="color: #007700">);<br />}</span></code></pre>
<p>In Yii, most probably you'll use <a href="guide-input-validation.html">form validation</a> to do alike checks.</p>
<h3>Escape output <a href="#escape-output" id="escape-output" class="hashlink">&para;</a></h3><p>Escape output means that depending on context where we're using data it should be escaped i.e. in context of HTML you
should escape <code>&lt;</code>, <code>&gt;</code> and alike special characters. In context of JavaScript or SQL it will be different set of characters.
Since it's error-prone to escape everything manually Yii provides various tools to perform escaping for different
contexts.</p>
<h2>Avoiding SQL injections <a href="#avoiding-sql-injections" id="avoiding-sql-injections" class="hashlink">&para;</a></h2><p>SQL injection happens when query text is formed by concatenating unescaped strings such as the following:</p>
<pre><code class="language-php"><span style="color: #0000BB">$username&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">];<br /></span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;*&nbsp;FROM&nbsp;user&nbsp;WHERE&nbsp;username&nbsp;=&nbsp;'</span><span style="color: #0000BB">$username</span><span style="color: #DD0000">'"</span><span style="color: #007700">;</span></code></pre>
<p>Instead of supplying correct username attacker could give your applications something like <code>'; DROP TABLE user; --</code>.
Resulting SQL will be the following:</p>
<pre><code class="language-sql">SELECT * FROM user WHERE username = ''; DROP TABLE user; --'
</code></pre>
<p>This is valid query that will search for users with empty username and then will drop <code>user</code> table most probably
resulting in broken website and data loss (you've set up regular backups, right?).</p>
<p>In Yii most of database querying happens via <a href="guide-db-active-record.html">Active Record</a> which properly uses PDO prepared
statements internally. In case of prepared statements it's not possible to manipulate query as was demonstrated above.</p>
<p>Still, sometimes you need <a href="guide-db-dao.html">raw queries</a> or <a href="guide-db-query-builder.html">query builder</a>. In this case you should use
safe ways of passing data. If data is used for column values it's preferred to use prepared statements:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #FF8000">//&nbsp;query&nbsp;builder<br /></span><span style="color: #0000BB">$userIDs&nbsp;</span><span style="color: #007700">=&nbsp;(new&nbsp;</span><span style="color: #0000BB">Query</span><span style="color: #007700">())<br />&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">select</span><span style="color: #007700">(</span><span style="color: #DD0000">'id'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">from</span><span style="color: #007700">(</span><span style="color: #DD0000">'user'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">where</span><span style="color: #007700">(</span><span style="color: #DD0000">'status=:status'</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">':status'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">])<br />&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">all</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;DAO<br /></span><span style="color: #0000BB">$userIDs&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$connection<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;id&nbsp;FROM&nbsp;user&nbsp;where&nbsp;status=:status'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">bindValues</span><span style="color: #007700">([</span><span style="color: #DD0000">':status'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$status</span><span style="color: #007700">])<br />&nbsp;&nbsp;&nbsp;&nbsp;-&gt;</span><span style="color: #0000BB">queryColumn</span><span style="color: #007700">();</span></code></pre>
<p>If data is used to specify column names or table names the best thing to do is to allow only predefined set of values:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">actionList</span><span style="color: #007700">(</span><span style="color: #0000BB">$orderBy&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">in_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$orderBy</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'status'</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #0000BB">BadRequestHttpException</span><span style="color: #007700">(</span><span style="color: #DD0000">'Only&nbsp;name&nbsp;and&nbsp;status&nbsp;are&nbsp;allowed&nbsp;to&nbsp;order&nbsp;by.'</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...<br /></span><span style="color: #007700">}</span></code></pre>
<p>In case it's not possible, table and column names should be escaped. Yii has special syntax for such escaping
which allows doing it the same way for all databases it supports:</p>
<pre><code class="language-php"><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;COUNT([[</span><span style="color: #0000BB">$column</span><span style="color: #DD0000">]])&nbsp;FROM&nbsp;{{table}}"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$rowCount&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$connection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">createCommand</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">queryScalar</span><span style="color: #007700">();</span></code></pre>
<p>You can get details about the syntax in <a href="guide-db-dao.html#quoting-table-and-column-names">Quoting Table and Column Names</a>.</p>
<h2>Avoiding XSS <a href="#avoiding-xss" id="avoiding-xss" class="hashlink">&para;</a></h2><p>XSS or cross-site scripting happens when output isn't escaped properly when outputting HTML to the browser. For example,
if user can enter his name and instead of <code>Alexander</code> he enters <code>&lt;script&gt;alert('Hello!');&lt;/script&gt;</code>, every page that
outputs user name without escaping it will execute JavaScript <code>alert('Hello!');</code> resulting in alert box popping up
in a browser. Depending on website instead of innocent alert such script could send messages using your name or even
perform bank transactions.</p>
<p>Avoiding XSS is quite easy in Yii. There are generally two cases:</p>
<ol>
<li>You want data to be outputted as plain text.</li>
<li>You want data to be outputted as HTML.</li>
</ol>
<p>If all you need is plain text then escaping is as easy as the following:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">&lt;?=&nbsp;\</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">helpers</span><span style="color: #007700">\</span><span style="color: #0000BB">Html</span><span style="color: #007700">::</span><span style="color: #0000BB">encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$username</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span></code></pre>
<p>If it should be HTML we could get some help from HtmlPurifier:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">&lt;?=&nbsp;\</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">helpers</span><span style="color: #007700">\</span><span style="color: #0000BB">HtmlPurifier</span><span style="color: #007700">::</span><span style="color: #0000BB">process</span><span style="color: #007700">(</span><span style="color: #0000BB">$description</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span></code></pre>
<p>Note that HtmlPurifier processing is quite heavy so consider adding caching.</p>
<h2>Avoiding CSRF <a href="#avoiding-csrf" id="avoiding-csrf" class="hashlink">&para;</a></h2><p>CSRF is an abbreviation for cross-site request forgery. The idea is that many applications assume that requests coming
from a user browser are made by the user himself. It could be false.</p>
<p>For example, <code>an.example.com</code> website has <code>/logout</code> URL that, when accessed using a simple GET, logs user out. As long
as it's requested by the user itself everything is OK but one day bad guys are somehow posting
<code>&lt;img src="http://an.example.com/logout"&gt;</code> on a forum user visits frequently. Browser doesn't make any difference between
requesting an image or requesting a page so when user opens a page with such <code>img</code> tag he's being logged out from
<code>an.example.com</code>.</p>
<p>That's the basic idea. One can say that logging user out is nothing serious. Well, sending POST isn't much trickier.</p>
<p>In order to avoid CSRF you should always:</p>
<ol>
<li>Follow HTTP specification i.e. GET should not change application state.</li>
<li>Keep Yii CSRF protection enabled.</li>
</ol>
<h2>Avoiding file exposure <a href="#avoiding-file-exposure" id="avoiding-file-exposure" class="hashlink">&para;</a></h2><p>By default server webroot is meant to be pointed to <code>web</code> directory where <code>index.php</code> is. In case of shared hosting
environments it could be impossible to achieve so we'll end up with all the code, configs and logs in server webroot.</p>
<p>If it's the case don't forget to deny access to everything except <code>web</code>. If it can't be done consider hosting your
application elsewhere.</p>
<h2>Avoiding debug info and tools at production <a href="#avoiding-debug-info-and-tools-at-production" id="avoiding-debug-info-and-tools-at-production" class="hashlink">&para;</a></h2><p>In debug mode Yii shows quite verbose errors which are certainly helpful for development. The thing is that these
verbose errors are handy for attacker as well since these could reveal database structure, configuration values and
parts of your code. Never run production applications with <code>YII_DEBUG</code> set to <code>true</code> in your <code>index.php</code>.</p>
<p>You should never enalble Gii at production. It could be used to get information about database structure, code and to
simply rewrite code with what's generated by Gii.</p>
<p>Debug toolbar should be avoided at production unless really necessary. It exposes all the application and config
details possible. If you absolutely need it check twice that access is properly restricted to your IP only.</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Sat, 21 Mar 2015 22:11:26 +0000</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// focus the search field
searchBox.focus();

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script><script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['site._setAccount', 'UA-5843896-1']);
_gaq.push(['site._trackPageview']);

(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
</body>

<!-- Mirrored from www.yiiframework.com/doc-2.0/guide-security-best-practices.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 27 May 2015 18:11:15 GMT -->
</html>
