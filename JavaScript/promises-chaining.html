<html>
<head>
    <title>JavaScript Promises</title>
    <link rel="stylesheet" href="../_libraries/bootstrap.css"/>
    <script type="text/javascript" src='../_libraries/bootstrap+jquery.js'></script>
    <script type="text/javascript" src='common.js'></script>
    <script type="text/javascript">
        (function () {

            function wait(duration) {
                console.log('waiting '+duration+' seconds');
                return new Promise(function (resolve) {
                    setTimeout(function () {
                        resolve("response");
                    }, duration*1000);
                });
            }

            var successHandler = function (res) {
                console.log('Inside successHandler. Here is the response:');
                console.log(res);
                return wait(1).then(function (res) {
                    console.log('Inside then of successHandler. Here is the response:');
                    console.log(res);
                    return "returned from successHandler";
                });
            };

            var successHandler2 = function (res) {
                console.log('Inside successHandler2. Here is the response:');
                console.log(res);
                return "returned from successHandler2";
            };

            var ret = wait(1).then(successHandler).then(successHandler2).then(successHandler);
            console.log(ret);

        })();
    </script>
</head>

<body>
    <div id="output">See Console Please</div>
</body>
</html>
